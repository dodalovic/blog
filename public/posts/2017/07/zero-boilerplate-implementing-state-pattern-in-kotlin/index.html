<!DOCTYPE html>
<html lang="en">
    <head>
        <meta charset="UTF-8">
<meta http-equiv="X-UA-Compatible" content="ie=edge">
<meta name="viewport" content="width=device-width, initial-scale=1, shrink-to-fit=no">
<meta name="author"
    content="Dusan Odalovic">
<meta name="description"
    content="State pattern is a pretty nice solution for solving problems related to changing behavior of some component(class) at runtime, which varies depending on current state of that object. Clients of our class having dynamic behavior have an impression that, upon interaction with that class, it seems like there’s different implementation of that object as of that interaction. There’s no magic involved – we’re just using composition, and our dynamic object just delegates call to State object it encapsulates." />
<meta name="keywords" content="[homepage blog informatics it development programming projects github cloud software engineering]" />
<meta name="robots" content="noodp" />
<link rel="canonical" href="https://dodalovic.github.io/posts/2017/07/zero-boilerplate-implementing-state-pattern-in-kotlin/" />


<title>
    
    Zero boilerplate implementing state pattern in kotlin :: Dusan Odalovic  — Homepage &amp; Blog
    
</title>



<link href="https://cdnjs.cloudflare.com/ajax/libs/flag-icon-css/3.2.1/css/flag-icon.min.css" rel="stylesheet"
    type="text/css">



<link rel="stylesheet" href="https://dodalovic.github.io/main.min.7bfbbe12786fa0ded4b4c0d792cbb36a5bd0bdb0b856dde57aa7b1f6fe0f2b87.css">



<link rel="apple-touch-icon" sizes="180x180" href="https://dodalovic.github.io/apple-touch-icon.png">
<link rel="icon" type="image/png" sizes="32x32" href="https://dodalovic.github.io/favicon-32x32.png">
<link rel="icon" type="image/png" sizes="16x16" href="https://dodalovic.github.io/favicon-16x16.png">
<link rel="manifest" href="https://dodalovic.github.io/site.webmanifest">
<link rel="mask-icon" href="https://dodalovic.github.io/safari-pinned-tab.svg" color="#252627">
<link rel="shortcut icon" href="https://dodalovic.github.io/favicon.ico">
<meta name="theme-color" content="#252627"><meta itemprop="name" content="Zero boilerplate implementing state pattern in kotlin">
<meta itemprop="description" content="State pattern is a pretty nice solution for solving problems related to changing behavior of some component(class) at runtime, which varies depending on current state of that object. Clients of our class having dynamic behavior have an impression that, upon interaction with that class, it seems like there’s different implementation of that object as of that interaction. There’s no magic involved – we’re just using composition, and our dynamic object just delegates call to State object it encapsulates.">


<meta itemprop="datePublished" content="2017-07-30T13:35:00&#43;01:00" />
<meta itemprop="dateModified" content="2019-09-09T20:18:51&#43;02:00" />
<meta itemprop="wordCount" content="445">



<meta itemprop="keywords" content="kotlin,software development,software patterns," />
<meta name="twitter:card" content="summary"/>
<meta name="twitter:title" content="Zero boilerplate implementing state pattern in kotlin"/>
<meta name="twitter:description" content="State pattern is a pretty nice solution for solving problems related to changing behavior of some component(class) at runtime, which varies depending on current state of that object. Clients of our class having dynamic behavior have an impression that, upon interaction with that class, it seems like there’s different implementation of that object as of that interaction. There’s no magic involved – we’re just using composition, and our dynamic object just delegates call to State object it encapsulates."/>




<meta property="article:published_time" content="2017-07-30 13:35:00 &#43;0100 &#43;0100" />







    </head>

    <body class="">
        <div class="container">
            <header class="header">
    <span class="header__inner">
        <a href="https://dodalovic.github.io/" style="text-decoration: none;">
    <div class="logo">
        
            <span class="logo__mark">></span>
            <span class="logo__text">home</span>
            <span class="logo__cursor"></span>
        
    </div>
</a>


        <span class="header__right">
            
                <nav class="menu">
    <ul class="menu__inner"><li><a href="https://dodalovic.github.io/about-me/">About me</a></li><li><a href="https://dodalovic.github.io/posts/">Posts</a></li><li><a href="https://dodalovic.github.io/works/">Works</a></li>
    </ul>
</nav>

                <span class="menu-trigger">
                    <svg xmlns="http://www.w3.org/2000/svg" viewBox="0 0 24 24">
                        <path d="M0 0h24v24H0z" fill="none"/>
                        <path d="M3 18h18v-2H3v2zm0-5h18v-2H3v2zm0-7v2h18V6H3z"/>
                    </svg>
                </span>
            

            <span class="theme-toggle unselectable"><svg class="theme-toggler" width="24" height="24" viewBox="0 0 48 48" fill="none" xmlns="http://www.w3.org/2000/svg">
  <path d="M22 41C32.4934 41 41 32.4934 41 22C41 11.5066 32.4934 3 22
  3C11.5066 3 3 11.5066 3 22C3 32.4934 11.5066 41 22 41ZM7 22C7
  13.7157 13.7157 7 22 7V37C13.7157 37 7 30.2843 7 22Z"/>
</svg>
</span>
        </span>
    </span>
</header>


            <div class="content">
                
    <main class="post">

        <div class="post-info">
            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-clock"><circle cx="12" cy="12" r="10"></circle><polyline points="12 6 12 12 16 14"></polyline></svg>3 minutes

            

            </p>
        </div>

        <article>
            <h1 class="post-title"><a href="https://dodalovic.github.io/posts/2017/07/zero-boilerplate-implementing-state-pattern-in-kotlin/">Zero boilerplate implementing state pattern in kotlin</a></h1>

            

            <div class="post-content">
                <p><a href="https://en.wikipedia.org/wiki/State_pattern" target="_blank"><em>State pattern</em></a> is a pretty nice solution for solving
 problems related to changing behavior of some component(class) at runtime, which varies depending on
  current state of that object. Clients of our class having dynamic behavior have an impression that,
  upon interaction with that class, it seems like there’s different implementation of that object as of
  that interaction. There’s no magic involved – we’re just using composition, and our dynamic object just
  delegates call to <code>State</code> object it encapsulates. Interface of <code>State</code> object defines set of actions
  (methods) that change behavior of our wrapping class (set of actions that cause system to transition).
  <code>State</code> implementations are those that are in charge of making transitions from state to state.</p>

<p>Here’s an example of coffee machine, that acts differently based on state it’s currently in.
Here, <code>CoffeeMachine</code> is our dynamic class, and it encapsulates instance of our <code>CoffeeMachineState</code> interface.
We initially set <code>Off</code> implementation of <code>State</code> when starting our coffee machine. Then, our implementations
transition the state, based on different actions being performed.</p>

<pre><code class="language-kotlin">
package patterns.state

class CoffeeMachine {
    var state: CoffeeMachineState
    val MAX_BEANS_QUANTITY = 100
    val MAX_WATER_QUANTITY = 100
    var beansQuantity = 0
    var waterQuantity = 0
    val offState = Off(this)
    val noIngredients = NoIngredients(this)
    val ready = Ready(this)

    init {
        state = offState
    }

    fun turnOn() = state.turnOn()
    fun fillInBeans(quantity: Int) = state.fillInBeans(quantity)
    fun fillInWater(quantity: Int) = state.fillInWater(quantity)
    fun makeCoffee() = state.makeCoffee()
    fun turnOff() = state.turnOff()

    override fun toString(): String {
        return &quot;&quot;&quot;COFFEE MACHINE → ${state::class.simpleName}
        |   water quantity : $waterQuantity
        |   beans quantity : $beansQuantity
        |&quot;&quot;&quot;.trimMargin()
    }
}

abstract class CoffeeMachineState(val coffeeMachine: CoffeeMachine) {
    open fun makeCoffee(): Unit = throw UnsupportedOperationException(&quot;Operation not supported&quot;)
    open fun fillInBeans(quantity: Int): Unit = throw UnsupportedOperationException(&quot;Operation not supported&quot;)
    open fun fillInWater(quantity: Int): Unit = throw UnsupportedOperationException(&quot;Operation not supported&quot;)
    open fun turnOn(): Unit = throw UnsupportedOperationException(&quot;Operation not supported&quot;)
    fun turnOff() {
        coffeeMachine.state = coffeeMachine.offState
    }
}

class Off(coffeeMachine: CoffeeMachine) : CoffeeMachineState(coffeeMachine) {
    override fun turnOn() {
        coffeeMachine.state = coffeeMachine.noIngredients
        println(&quot;Coffee machine turned on&quot;)
    }
}

class NoIngredients(coffeeMachine: CoffeeMachine) : CoffeeMachineState(coffeeMachine) {
    override fun fillInBeans(quantity: Int) {
        if ((coffeeMachine.beansQuantity + quantity) &lt;= coffeeMachine.MAX_BEANS_QUANTITY) {
            coffeeMachine.beansQuantity += quantity
            println(&quot;Beans filled in&quot;)
            if (coffeeMachine.waterQuantity &gt; 0) {
                coffeeMachine.state = coffeeMachine.ready
            }
        }
    }

    override fun fillInWater(quantity: Int) {
        if ((coffeeMachine.waterQuantity + quantity) &lt;= coffeeMachine.MAX_WATER_QUANTITY) {
            coffeeMachine.waterQuantity += quantity
            println(&quot;Water filled in&quot;)
            if (coffeeMachine.beansQuantity &gt; 0) {
                coffeeMachine.state = coffeeMachine.ready
            }
        }
    }
}

class Ready(coffeeMachine: CoffeeMachine) : CoffeeMachineState(coffeeMachine) {
    override fun makeCoffee() {
        coffeeMachine.beansQuantity--
        coffeeMachine.waterQuantity--
        println(&quot;Making coffee ... DONE&quot;)
        if (coffeeMachine.beansQuantity == 0 || coffeeMachine.waterQuantity == 0) {
            coffeeMachine.state = coffeeMachine.noIngredients
        }
    }
}

fun main(args: Array&lt;String&gt;) {
    val coffeeMachine = CoffeeMachine()
    coffeeMachine.turnOn()
    println(coffeeMachine)
    coffeeMachine.fillInBeans(2)
    println(coffeeMachine)
    coffeeMachine.fillInWater(2)
    println(coffeeMachine)
    coffeeMachine.makeCoffee()
    println(coffeeMachine)
    coffeeMachine.makeCoffee()
    println(coffeeMachine)
    coffeeMachine.turnOff()
    println(coffeeMachine)
}

</code></pre>

            </div>
        </article>

        <hr />

        <div class="post-info">
                <p>
                    <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-tag meta-icon"><path d="M20.59 13.41l-7.17 7.17a2 2 0 0 1-2.83 0L2 12V2h10l8.59 8.59a2 2 0 0 1 0 2.82z"></path><line x1="7" y1="7" x2="7" y2="7"></line></svg><span class="tag"><a href="https://dodalovic.github.io/tags/kotlin">kotlin</a></span><span class="tag"><a href="https://dodalovic.github.io/tags/software-development">software development</a></span><span class="tag"><a href="https://dodalovic.github.io/tags/software-patterns">software patterns</a></span>
                </p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-file-text"><path d="M14 2H6a2 2 0 0 0-2 2v16a2 2 0 0 0 2 2h12a2 2 0 0 0 2-2V8z"></path><polyline points="14 2 14 8 20 8"></polyline><line x1="16" y1="13" x2="8" y2="13"></line><line x1="16" y1="17" x2="8" y2="17"></line><polyline points="10 9 9 9 8 9"></polyline></svg>445 Words</p>

            <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-calendar"><rect x="3" y="4" width="18" height="18" rx="2" ry="2"></rect><line x1="16" y1="2" x2="16" y2="6"></line><line x1="8" y1="2" x2="8" y2="6"></line><line x1="3" y1="10" x2="21" y2="10"></line></svg>2017-07-30 14:35 &#43;0200</p>
                <p><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-git-commit"><circle cx="12" cy="12" r="4"></circle><line x1="1.05" y1="12" x2="7" y2="12"></line><line x1="17.01" y1="12" x2="22.96" y2="12"></line></svg><a href="cee381cd3e1317abb9a1a755ddadcd0134c85c46" target="_blank" rel="noopener">cee381c</a> @ 2019-09-09</p>
        </div>

        
            <div class="pagination">
                <div class="pagination__title">
                    <span class="pagination__title-h"></span>
                    <hr />
                </div>

                <div class="pagination__buttons">
                    

                    
                        <span class="button next">
                            <a href="https://dodalovic.github.io/posts/2017/07/decorator-pattern-in-kotlin/">
                                <span class="button__text">Decorator pattern in kotlin</span>
                                <span class="button__icon">→</span>
                            </a>
                        </span>
                    
                </div>
            </div>
        

        
    </main>

            </div>

            
                <footer class="footer">
    <div class="footer__inner">
        <div class="footer__content">
            <span>&copy; 2019</span>
            
            <span><a href="https://dodalovic.github.io/">Dusan Odalovic</a></span>
            
            <span><a href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank" rel="noopener">CC BY-NC 4.0</a></span>
            <span> <a href="https://dodalovic.github.io/posts/index.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="18" height="18" viewBox="0 0 20 20" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a></span>
        </div>
    </div>
</footer>

            
        </div>

        




<script type="text/javascript" src="https://dodalovic.github.io/bundle.min.4c3fb12a087ceed4a52cb5d57068a9795c7069617a01ca70f788052ad66e1791779e6c72686e1dc0ca13dc03b0203204b6566bb0dd1ee80de2b7ff4d8fe53db2.js" integrity="sha512-TD&#43;xKgh87tSlLLXVcGipeVxwaWF6Acpw94gFKtZuF5F3nmxyaG4dwMoT3AOwIDIEtlZrsN0e6A3it/9Nj&#43;U9sg=="></script>



    </body>
</html>
